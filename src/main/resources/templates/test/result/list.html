<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Kết quả bài kiểm tra</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-4">
    <h2 class="mb-4">Kết quả bài kiểm tra</h2>

    <form method="get" action="/results" class="row g-3 mb-4">
        <div class="col-md-4">
            <select name="testId" class="form-select">
                <option value="">-- Chọn bài test --</option>
                <option th:each="t : ${tests}" th:value="${t.testId}" th:text="${t.testName}"></option>
            </select>
        </div>
        <div class="col-md-4">
            <select name="studentUsername" class="form-select">
                <option value="">-- Chọn học sinh --</option>
                <option th:each="s : ${students}"
                        th:value="${s.username}"
                        th:text="${s.fullName}"
                        th:selected="${s.username == studentUsername}"></option>
            </select>

        </div>
        <div class="col-md-4">
            <button type="submit" class="btn btn-primary">Lọc kết quả</button>
            <a href="/results/export" class="btn btn-success ms-2">Xuất CSV</a>
        </div>
    </form>

    <table class="table table-bordered table-hover">
        <thead class="table-light">
        <tr>
            <th>Học sinh</th>
            <th>Bài test</th>
            <th>Điểm</th>
            <th>Percentile</th>
            <th>Xếp loại</th>
            <th>Tên đăng nhập</th>
            <th>Ngày làm</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="r : ${results}">
            <td th:text="${r.fullName}"></td>
            <td th:text="${r.testName}"></td>
            <td th:text="${r.score}"></td>
            <td th:text="${r.percentile} + '%'"></td>
            <td th:text="${r.rank}"></td>
            <td th:text="${r.studentUsername}"></td>
            <td th:text="${#temporals.format(r.submittedAt, 'dd/MM/yyyy HH:mm')}"></td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>
